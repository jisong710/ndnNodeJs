import { Data } from "@ndn/packet";
import { Decoder, Encoder } from "@ndn/tlv";
import { Certificate } from "../cert/mod_browser.js";
import { StoreBase } from "./store-base_browser.js";
/** KV store of certificates. */
export class CertStore extends StoreBase {
    async get(name) {
        let { certBuffer } = await this.getValue(name);
        certBuffer = StoreBase.bufferFromStorable(certBuffer);
        return Certificate.fromData(new Decoder(certBuffer).decode(Data));
    }
    async insert(cert) {
        await this.insertValue(cert.name, {
            certBuffer: this.bufferToStorable(Encoder.encode(cert.data)),
        });
    }
}
